<mat-card class="add-user-card">
  <mat-card-header>
    <mat-card-title>Create New User</mat-card-title>
    <mat-card-subtitle>Enter the details below to add a new user</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
<div>
  <!-- Preview -->
<img *ngIf="previewUrl"
     [src]="previewUrl"
     alt="Avatar Preview"
     width="120"
     height="120"
     style="margin-top:10px;border-radius:50%;object-fit:cover;margin-left: 500px;">
 <mat-form-field appearance="fill" class="full-width">
  <mat-label>Upload Avatar</mat-label>

  <!-- Fake readonly field just for Material style -->
  <input matInput [value]="selectedFile?.name || ''" placeholder="Choose file" readonly />

  <!-- Hidden real file input -->
  <input type="file" #fileInput hidden (change)="onFileSelected($event)" accept="image/*" />

  <!-- Upload button -->
  <button mat-icon-button matSuffix type="button" (click)="fileInput.click()">
    <mat-icon>upload</mat-icon>
  </button>
</mat-form-field>



</div>

    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">

      <!-- Personal Information Section -->
      <div class="form-section">
        <h3 class="section-title">Personal Information</h3>
        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>First Name</mat-label>
            <input matInput formControlName="firstName" placeholder="Enter first name">
            <mat-error *ngIf="userForm.get('firstName')?.hasError('required')">
              First name is required
            </mat-error>
            <mat-error *ngIf="userForm.get('firstName')?.hasError('minlength')">
              First name must be at least 2 characters
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Last Name</mat-label>
            <input matInput formControlName="lastName" placeholder="Enter last name">
            <mat-error *ngIf="userForm.get('lastName')?.hasError('required')">
              Last name is required
            </mat-error>
            <mat-error *ngIf="userForm.get('lastName')?.hasError('minlength')">
              Last name must be at least 2 characters
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="Enter email address">
            <mat-error *ngIf="userForm.get('email')?.hasError('required')">
              Email is required
            </mat-error>
            <mat-error *ngIf="userForm.get('email')?.hasError('email')">
              Please enter a valid email address
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>CIN</mat-label>
            <input matInput formControlName="cin" placeholder="Enter CIN number">
            <mat-error *ngIf="userForm.get('cin')?.hasError('required')">
              CIN is required
            </mat-error>
            <mat-error *ngIf="userForm.get('cin')?.hasError('minlength')">
              CIN must be at least 8 characters
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Gender</mat-label>
            <mat-select formControlName="gender">
              <mat-option *ngFor="let gender of genderOptions" [value]="gender.value">
                {{gender.label}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('gender')?.hasError('required')">
              Gender is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Contract Start Date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="dateDebutContrat">
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="userForm.get('dateDebutContrat')?.hasError('required')">
              Contract start date is required
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Work Information Section -->
      <div class="form-section">
        <h3 class="section-title">Work Information</h3>
        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Salary</mat-label>
            <input matInput type="number" formControlName="salaire" placeholder="Enter salary">
            <span matTextPrefix>$&nbsp;</span>
            <mat-error *ngIf="userForm.get('salaire')?.hasError('required')">
              Salary is required
            </mat-error>
            <mat-error *ngIf="userForm.get('salaire')?.hasError('min')">
              Salary must be positive
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Hours of Work</mat-label>
            <input matInput type="number" formControlName="hoursOfWork" placeholder="Hours per week">
            <mat-error *ngIf="userForm.get('hoursOfWork')?.hasError('required')">
              Hours of work is required
            </mat-error>
            <mat-error *ngIf="userForm.get('hoursOfWork')?.hasError('min')">
              Hours must be at least 1
            </mat-error>
            <mat-error *ngIf="userForm.get('hoursOfWork')?.hasError('max')">
              Hours cannot exceed 80
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Site</mat-label>
            <mat-select formControlName="site">
              <mat-option *ngFor="let site of siteOptions" [value]="site.value">
                {{site.label}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('site')?.hasError('required')">
              Site is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Process</mat-label>
            <mat-select formControlName="processus">
              <mat-option *ngFor="let process of processusOptions" [value]="process.value">
                {{process.label}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('processus')?.hasError('required')">
              Process is required
            </mat-error>
          </mat-form-field>
        </div>
      </div>

      <!-- Experience Section -->
      <div class="form-section">
        <h3 class="section-title">Experience & Qualifications</h3>
        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Experience Level</mat-label>
            <mat-select formControlName="experience">
              <mat-option *ngFor="let exp of experienceOptions" [value]="exp.value">
                {{exp.label}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('experience')?.hasError('required')">
              Experience level is required
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Years of Experience</mat-label>
            <input matInput type="number" formControlName="yearsOfExperience" placeholder="Number of years">
            <mat-error *ngIf="userForm.get('yearsOfExperience')?.hasError('required')">
              Years of experience is required
            </mat-error>
            <mat-error *ngIf="userForm.get('yearsOfExperience')?.hasError('min')">
              Years must be 0 or more
            </mat-error>
            <mat-error *ngIf="userForm.get('yearsOfExperience')?.hasError('max')">
              Years cannot exceed 50
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="form-field full-width">
            <mat-label>Certification</mat-label>
            <mat-select formControlName="certification">
              <mat-option *ngFor="let cert of certificationOptions" [value]="cert.value">
                {{cert.label}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="userForm.get('certification')?.hasError('required')">
              Certification is required
            </mat-error>
          </mat-form-field>
        </div>
      </div>


<div class="button-container">
<button mat-stroked-button class="add-btn"
        type="submit"
        [disabled]="isSubmitting || userForm.invalid">
    Create User
</button>


  <button mat-stroked-button class="reset-btn" type="reset" (click)="resetForm()" [disabled]="isSubmitting" >
    Reset
  </button>
</div>




    </form>
  </mat-card-content>
</mat-card>
