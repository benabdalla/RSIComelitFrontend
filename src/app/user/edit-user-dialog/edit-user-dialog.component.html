<div class="dialog-header">
  <h2 mat-dialog-title>Edit User</h2>
  <button mat-icon-button mat-dialog-close class="close-button">
    <mat-icon>close</mat-icon>
  </button>
</div>

<mat-dialog-content class="dialog-content">
  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="edit-user-form">

    <!-- Personal Information Section -->
    <div class="form-section">
      <h3 class="section-title">Personal Information</h3>
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>First Name</mat-label>
          <input matInput formControlName="firstName" placeholder="Enter first name">
          <mat-error *ngIf="userForm.get('firstName')?.hasError('required')">
            First name is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Last Name</mat-label>
          <input matInput formControlName="lastName" placeholder="Enter last name">
          <mat-error *ngIf="userForm.get('lastName')?.hasError('required')">
            Last name is required
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" placeholder="Enter email address">
          <mat-error *ngIf="userForm.get('email')?.hasError('required')">
            Email is required
          </mat-error>
          <mat-error *ngIf="userForm.get('email')?.hasError('email')">
            Please enter a valid email
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>CIN</mat-label>
          <input matInput formControlName="cin" placeholder="Enter CIN number">
          <mat-error *ngIf="userForm.get('cin')?.hasError('required')">
            CIN is required
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Gender</mat-label>
          <mat-select formControlName="gender">
            <mat-option *ngFor="let gender of genderOptions" [value]="gender.value">
              {{gender.label}}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="userForm.get('gender')?.hasError('required')">
            Gender is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Contract Start Date</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="dateDebutContrat">
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="userForm.get('dateDebutContrat')?.hasError('required')">
            Contract start date is required
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <!-- Work Information Section -->
    <div class="form-section">
      <h3 class="section-title">Work Information</h3>
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Salary</mat-label>
          <input matInput type="number" formControlName="salaire" placeholder="Enter salary">
          <span matTextPrefix>$&nbsp;</span>
          <mat-error *ngIf="userForm.get('salaire')?.hasError('required')">
            Salary is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Hours of Work</mat-label>
          <input matInput type="number" formControlName="hoursOfWork" placeholder="Hours per week">
          <mat-error *ngIf="userForm.get('hoursOfWork')?.hasError('required')">
            Hours of work is required
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Site</mat-label>
          <mat-select formControlName="site">
            <mat-option *ngFor="let site of siteOptions" [value]="site.value">
              {{site.label}}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="userForm.get('site')?.hasError('required')">
            Site is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Process</mat-label>
          <mat-select formControlName="processus">
            <mat-option *ngFor="let process of processusOptions" [value]="process.value">
              {{process.label}}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="userForm.get('processus')?.hasError('required')">
            Process is required
          </mat-error>
        </mat-form-field>
      </div>
    </div>

    <!-- Experience Section -->
    <div class="form-section">
      <h3 class="section-title">Experience & Qualifications</h3>
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Experience Level</mat-label>
          <mat-select formControlName="experience">
            <mat-option *ngFor="let exp of experienceOptions" [value]="exp.value">
              {{exp.label}}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="userForm.get('experience')?.hasError('required')">
            Experience level is required
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Years of Experience</mat-label>
          <input matInput type="number" formControlName="yearsOfExperience" placeholder="Number of years">
          <mat-error *ngIf="userForm.get('yearsOfExperience')?.hasError('required')">
            Years of experience is required
          </mat-error>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field full-width">
          <mat-label>Certification</mat-label>
          <mat-select formControlName="certification">
            <mat-option *ngFor="let cert of certificationOptions" [value]="cert.value">
              {{cert.label}}
            </mat-option>
          </mat-select>
          <mat-error *ngIf="userForm.get('certification')?.hasError('required')">
            Certification is required
          </mat-error>
        </mat-form-field>
      </div>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end" class="dialog-actions">
  <button mat-button type="button" (click)="onCancel()" [disabled]="isSubmitting">
    Cancel
  </button>
  <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="isSubmitting">
    <mat-spinner *ngIf="isSubmitting" diameter="16" class="button-spinner"></mat-spinner>
    <mat-icon *ngIf="!isSubmitting">save</mat-icon>
    {{ isSubmitting ? 'Saving...' : 'Save Changes' }}
  </button>
</mat-dialog-actions>
